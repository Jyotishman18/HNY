<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Happy New Year Kuchupuchu â¤ï¸</title>
    <link rel="stylesheet" href="../css/style.css">
</head>

<body class="page-long final-bg">

    <!-- Fireworks Canvas -->
    <canvas id="fireworksCanvas"></canvas>

    <!-- Animated Background -->
    <div class="bg"></div>

    <!-- Floating Hearts -->
    <div class="hearts">
        <span>â¤ï¸</span><span>ğŸ’–</span><span>ğŸ’•</span><span>ğŸ’—</span><span>ğŸ’˜</span>
        <span>â¤ï¸</span><span>ğŸ’–</span><span>ğŸ’•</span><span>ğŸ’—</span>
    </div>

    <!-- Main Content -->
    <div class="container final-page">
        <h1 class="glow-text">Happy New Year ğŸ†â¤ï¸</h1>

        <p class="final-text">
            I love you, my dearest <b>Kuchupuchu</b> ğŸ’•<br><br>
            You are my smile,<br>
            my peace,<br>
            and my favorite part of every day.<br><br>
            I promise to choose you â€”<br>
            this year ğŸ†<br>
            next year ğŸ’–<br>
            and every year after ğŸ¤
        </p>

        <p class="signature">
            â€” Yours, forever & always ğŸ’
        </p>
    </div>

    <!-- Cat Guide -->
    <div class="cat-guide">
        <img src="../images/cat/cat.png" alt="Mochi the Cat">
        <div class="speech">
            Okayâ€¦ get married already ğŸ˜½ğŸ†
        </div>
    </div>

    <!-- ğŸµ MUSIC (PAGE 4 ONLY) -->
    <audio id="bgMusic" loop>
        <source src="../Music/music.mp3" type="audio/mpeg">
    </audio>

    <!-- Music Button -->
    <button class="music-btn" onclick="toggleMusic()">ğŸ”Š</button>

    <!-- ğŸ† FIREWORKS SCRIPT -->
    <script>
        const canvas = document.getElementById("fireworksCanvas");
        const ctx = canvas.getContext("2d");

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener("resize", resizeCanvas);

        class Firework {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height;
                this.targetY = Math.random() * canvas.height * 0.5;
                this.speed = Math.random() * 3 + 4;
                this.exploded = false;
                this.particles = [];
                this.color = `hsl(${Math.random() * 360}, 100%, 70%)`;
            }

            explode() {
                for (let i = 0; i < 30; i++) {
                    this.particles.push({
                        x: this.x,
                        y: this.y,
                        angle: Math.random() * Math.PI * 2,
                        speed: Math.random() * 4 + 1,
                        alpha: 1
                    });
                }
            }

            update() {
                if (!this.exploded) {
                    this.y -= this.speed;
                    if (this.y <= this.targetY) {
                        this.exploded = true;
                        this.explode();
                    }
                } else {
                    this.particles.forEach(p => {
                        p.x += Math.cos(p.angle) * p.speed;
                        p.y += Math.sin(p.angle) * p.speed;
                        p.alpha -= 0.02;
                    });
                }
            }

            draw() {
                if (!this.exploded) {
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = this.color;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                } else {
                    this.particles.forEach(p => {
                        ctx.globalAlpha = p.alpha;
                        ctx.fillStyle = this.color;
                        ctx.shadowBlur = 20;
                        ctx.shadowColor = this.color;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, 2.5, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.shadowBlur = 0;
                        ctx.globalAlpha = 1;
                    });
                }
            }
        }

        let fireworks = [];

        function animateFireworks() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (Math.random() < 0.04) {
                fireworks.push(new Firework());
            }

            fireworks.forEach((fw, i) => {
                fw.update();
                fw.draw();
                if (fw.exploded && fw.particles.every(p => p.alpha <= 0)) {
                    fireworks.splice(i, 1);
                }
            });

            requestAnimationFrame(animateFireworks);
        }

        animateFireworks();
    </script>

    <!-- ğŸµ MUSIC CONTROL (AUTOSTART ON FIRST INTERACTION) -->
    <script>
        const music = document.getElementById("bgMusic");
        const btn = document.querySelector(".music-btn");
        let started = false;

        function startMusic() {
            if (!started) {
                music.volume = 0.4;
                music.play().catch(() => {});
                btn.textContent = "ğŸ”‡";
                started = true;
            }
        }

        function toggleMusic() {
            if (music.paused) {
                music.play();
                btn.textContent = "ğŸ”‡";
            } else {
                music.pause();
                btn.textContent = "ğŸ”Š";
            }
        }

        // ğŸ”¥ Browser-safe autoplay
        document.addEventListener("click", startMusic, { once: true });
    </script>

    <!-- Cursor Effect -->
    <div class="cursor-trail"></div>
    <script src="../js/cursor.js"></script>

</body>
</html>


